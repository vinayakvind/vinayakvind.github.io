<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-adsense-account" content="ca-pub-6404032174018146">
  <title>World Priority - What Should Humanity Focus On?</title>
  <meta name="description" content="Vote on the most important issues facing humanity. See global trends by country and what people think the world should prioritize.">
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6404032174018146" crossorigin="anonymous"></script>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      color: #fff;
    }
    
    /* Header */
    .header {
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      padding: 15px 30px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .globe {
      font-size: 40px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .logo h1 {
      font-size: 24px;
      font-weight: 900;
      background: linear-gradient(135deg, #00d4ff, #7b2cbf);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .logo .tagline {
      font-size: 11px;
      color: rgba(255,255,255,0.6);
      letter-spacing: 2px;
      text-transform: uppercase;
    }
    
    .auth-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .user-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.1);
      padding: 8px 15px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 600;
    }
    
    .country-flag {
      font-size: 20px;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #00d4ff, #7b2cbf);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0,212,255,0.3);
    }
    
    .btn-outline {
      background: transparent;
      border: 2px solid rgba(255,255,255,0.3);
      color: white;
    }
    
    .btn-outline:hover {
      background: rgba(255,255,255,0.1);
    }
    
    /* Hero Section */
    .hero {
      text-align: center;
      padding: 60px 20px 40px;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .hero h2 {
      font-size: 48px;
      font-weight: 900;
      margin-bottom: 20px;
      line-height: 1.2;
    }
    
    .hero h2 span {
      background: linear-gradient(135deg, #00d4ff, #7b2cbf);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .hero p {
      font-size: 18px;
      color: rgba(255,255,255,0.7);
      line-height: 1.6;
      max-width: 700px;
      margin: 0 auto;
    }
    
    /* Stats Bar */
    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 40px;
      padding: 30px;
      flex-wrap: wrap;
    }
    
    .stat {
      text-align: center;
    }
    
    .stat-value {
      font-size: 36px;
      font-weight: 900;
      background: linear-gradient(135deg, #00d4ff, #7b2cbf);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .stat-label {
      font-size: 12px;
      color: rgba(255,255,255,0.5);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-top: 5px;
    }
    
    /* Country Leaderboard */
    .country-section {
      max-width: 1200px;
      margin: 0 auto 40px;
      padding: 0 20px;
    }
    
    .country-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    
    .country-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s;
    }
    
    .country-card:hover {
      background: rgba(255,255,255,0.08);
      border-color: rgba(0,212,255,0.3);
      transform: translateY(-3px);
    }
    
    .country-card .flag {
      font-size: 40px;
      margin-bottom: 10px;
    }
    
    .country-card .country-name {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .country-card .country-votes {
      font-size: 24px;
      font-weight: 900;
      color: #00d4ff;
    }
    
    /* Main Container */
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 20px 60px;
    }
    
    /* Section Title */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .section-title {
      font-size: 28px;
      font-weight: 800;
    }
    
    .section-title span {
      color: #00d4ff;
    }
    
    /* Priority Cards */
    .priority-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .priority-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 25px;
      display: flex;
      align-items: center;
      gap: 20px;
      transition: all 0.3s;
    }
    
    .priority-card:hover {
      background: rgba(255,255,255,0.08);
      border-color: rgba(0,212,255,0.3);
      transform: translateX(5px);
    }
    
    .rank {
      font-size: 32px;
      font-weight: 900;
      min-width: 50px;
      text-align: center;
    }
    
    .rank.gold { color: #ffd700; }
    .rank.silver { color: #c0c0c0; }
    .rank.bronze { color: #cd7f32; }
    .rank.normal { color: rgba(255,255,255,0.4); }
    
    .priority-info {
      flex: 1;
    }
    
    .priority-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .priority-meta {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .category-tag {
      background: linear-gradient(135deg, #00d4ff, #7b2cbf);
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .priority-desc {
      font-size: 13px;
      color: rgba(255,255,255,0.5);
    }
    
    .country-breakdown {
      font-size: 12px;
      color: rgba(255,255,255,0.4);
      margin-top: 8px;
    }
    
    .vote-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    
    .vote-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid rgba(0,212,255,0.5);
      background: rgba(0,212,255,0.1);
      color: #00d4ff;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .vote-btn:hover:not(:disabled) {
      background: #00d4ff;
      color: #1a1a2e;
      transform: scale(1.1);
    }
    
    .vote-btn.voted {
      background: #00d4ff;
      color: #1a1a2e;
    }
    
    .vote-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .vote-count {
      font-size: 18px;
      font-weight: 700;
      color: #00d4ff;
    }
    
    /* Add Priority Section */
    .add-section {
      margin-top: 40px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 30px;
    }
    
    .add-section h3 {
      font-size: 22px;
      margin-bottom: 20px;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 14px;
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      background: rgba(255,255,255,0.05);
      color: white;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #00d4ff;
    }
    
    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }
    
    .form-group select option {
      background: #1a1a2e;
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      align-items: center;
      justify-content: center;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 40px;
      border-radius: 20px;
      max-width: 450px;
      width: 90%;
      position: relative;
    }
    
    .modal-content h3 {
      font-size: 24px;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .modal-content p {
      color: rgba(255,255,255,0.6);
      margin-bottom: 25px;
      text-align: center;
    }
    
    .close-modal {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 28px;
      background: none;
      border: none;
      color: rgba(255,255,255,0.5);
      cursor: pointer;
      line-height: 1;
    }
    
    .close-modal:hover {
      color: white;
    }
    
    /* Alert */
    .alert {
      position: fixed;
      top: 100px;
      left: 50%;
      transform: translateX(-50%);
      padding: 15px 30px;
      border-radius: 10px;
      font-weight: 600;
      z-index: 3000;
      animation: slideDown 0.3s ease;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    }
    
    @keyframes slideDown {
      from { top: 70px; opacity: 0; }
      to { top: 100px; opacity: 1; }
    }
    
    .alert-success {
      background: linear-gradient(135deg, #00d4ff, #7b2cbf);
      color: white;
    }
    
    .alert-error {
      background: #dc3545;
      color: white;
    }
    
    /* Footer */
    .footer {
      text-align: center;
      padding: 30px;
      color: rgba(255,255,255,0.4);
      font-size: 14px;
      border-top: 1px solid rgba(255,255,255,0.1);
      margin-top: 40px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .hero h2 { font-size: 32px; }
      .form-row { grid-template-columns: 1fr; }
      .priority-card { flex-direction: column; text-align: center; }
      .stats-bar { gap: 30px; }
      .header-content { justify-content: center; }
      .country-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <span class="globe">üåç</span>
        <div>
          <h1>World Priority</h1>
          <div class="tagline">Shape The Future</div>
        </div>
      </div>
      
      <div class="auth-section">
        <div id="userSection" style="display: none;">
          <div class="user-badge">
            <span class="country-flag" id="userFlag"></span>
            <span id="userCountry"></span>
          </div>
          <button class="btn btn-outline" onclick="changeCountry()">Change Country</button>
        </div>
        <div id="setupSection">
          <button class="btn btn-primary" onclick="showCountryModal()">
            üåç Start Voting
          </button>
        </div>
      </div>
    </div>
  </header>
  
  <!-- Hero -->
  <section class="hero">
    <h2>What Should <span>Humanity</span> Focus On?</h2>
    <p>Vote on the most critical issues facing our world. See real-time trends by country and discover what people believe should be humanity's top priorities.</p>
  </section>
  
  <!-- Stats -->
  <div class="stats-bar">
    <div class="stat">
      <div class="stat-value" id="totalVotes">0</div>
      <div class="stat-label">Total Votes</div>
    </div>
    <div class="stat">
      <div class="stat-value" id="totalPriorities">0</div>
      <div class="stat-label">Priorities</div>
    </div>
    <div class="stat">
      <div class="stat-value" id="totalCountries">0</div>
      <div class="stat-label">Countries</div>
    </div>
  </div>
  
  <!-- Top Countries -->
  <div class="country-section">
    <div class="section-header">
      <h3 class="section-title">üåç Most Active <span>Countries</span></h3>
    </div>
    <div id="countryGrid" class="country-grid">
      <!-- Country cards will be loaded here -->
    </div>
  </div>
  
  <!-- Main Content -->
  <div class="container">
    <div class="section-header">
      <h3 class="section-title">üèÜ Global <span>Leaderboard</span></h3>
    </div>
    
    <div id="priorityList" class="priority-list">
      <!-- Priority items will be loaded here -->
    </div>
    
    <!-- Add Priority Section -->
    <div class="add-section">
      <h3>‚ú® Suggest a New Priority</h3>
      <form id="addPriorityForm" onsubmit="submitPriority(event)">
        <div class="form-row">
          <div class="form-group">
            <label>Priority Title</label>
            <input type="text" id="priorityTitle" placeholder="e.g., Climate Action" required maxlength="100">
          </div>
          <div class="form-group">
            <label>Category</label>
            <select id="priorityCategory" required>
              <option value="">Select category...</option>
              <option value="Environment">üå± Environment</option>
              <option value="Health">üè• Health</option>
              <option value="Education">üìö Education</option>
              <option value="Peace">‚òÆÔ∏è Peace & Security</option>
              <option value="Poverty">üí∞ Poverty & Inequality</option>
              <option value="Technology">ü§ñ Technology</option>
              <option value="Human Rights">‚öñÔ∏è Human Rights</option>
              <option value="Other">üåê Other</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>Description (optional)</label>
          <textarea id="priorityDesc" placeholder="Briefly explain why this is important..." maxlength="300"></textarea>
        </div>
        <button type="submit" class="btn btn-primary" style="width: 100%;">üöÄ Submit Priority</button>
      </form>
    </div>
  </div>
  
  <!-- Country Selection Modal -->
  <div id="countryModal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeCountryModal()">√ó</button>
      <h3>üåç Select Your Country</h3>
      <p>Help us understand global priorities by selecting your country</p>
      <div class="form-group">
        <select id="countrySelect" style="width: 100%; padding: 15px; font-size: 16px;">
          <option value="">Choose your country...</option>
        </select>
      </div>
      <button class="btn btn-primary" onclick="setCountry()" style="width: 100%; margin-top: 15px;">Continue</button>
    </div>
  </div>
  
  <!-- Footer -->
  <footer class="footer">
    <p>üåç World Priority - Making humanity's voice heard | ¬© 2026</p>
  </footer>
  
  <script>
    // ==========================================
    // WORLD PRIORITY - COUNTRY-BASED VOTING
    // ==========================================
    
    // Countries with flags
    const COUNTRIES = [
      { code: 'US', name: 'United States', flag: 'üá∫üá∏' },
      { code: 'IN', name: 'India', flag: 'üáÆüá≥' },
      { code: 'CN', name: 'China', flag: 'üá®üá≥' },
      { code: 'BR', name: 'Brazil', flag: 'üáßüá∑' },
      { code: 'ID', name: 'Indonesia', flag: 'üáÆüá©' },
      { code: 'PK', name: 'Pakistan', flag: 'üáµüá∞' },
      { code: 'NG', name: 'Nigeria', flag: 'üá≥üá¨' },
      { code: 'BD', name: 'Bangladesh', flag: 'üáßüá©' },
      { code: 'RU', name: 'Russia', flag: 'üá∑üá∫' },
      { code: 'MX', name: 'Mexico', flag: 'üá≤üáΩ' },
      { code: 'JP', name: 'Japan', flag: 'üáØüáµ' },
      { code: 'ET', name: 'Ethiopia', flag: 'üá™üáπ' },
      { code: 'PH', name: 'Philippines', flag: 'üáµüá≠' },
      { code: 'EG', name: 'Egypt', flag: 'üá™üá¨' },
      { code: 'VN', name: 'Vietnam', flag: 'üáªüá≥' },
      { code: 'CD', name: 'DR Congo', flag: 'üá®üá©' },
      { code: 'TR', name: 'Turkey', flag: 'üáπüá∑' },
      { code: 'IR', name: 'Iran', flag: 'üáÆüá∑' },
      { code: 'DE', name: 'Germany', flag: 'üá©üá™' },
      { code: 'TH', name: 'Thailand', flag: 'üáπüá≠' },
      { code: 'GB', name: 'United Kingdom', flag: 'üá¨üáß' },
      { code: 'FR', name: 'France', flag: 'üá´üá∑' },
      { code: 'IT', name: 'Italy', flag: 'üáÆüáπ' },
      { code: 'ZA', name: 'South Africa', flag: 'üáøüá¶' },
      { code: 'MM', name: 'Myanmar', flag: 'üá≤üá≤' },
      { code: 'KR', name: 'South Korea', flag: 'üá∞üá∑' },
      { code: 'CO', name: 'Colombia', flag: 'üá®üá¥' },
      { code: 'ES', name: 'Spain', flag: 'üá™üá∏' },
      { code: 'AR', name: 'Argentina', flag: 'üá¶üá∑' },
      { code: 'DZ', name: 'Algeria', flag: 'üá©üáø' },
      { code: 'SD', name: 'Sudan', flag: 'üá∏üá©' },
      { code: 'UG', name: 'Uganda', flag: 'üá∫üá¨' },
      { code: 'UA', name: 'Ukraine', flag: 'üá∫üá¶' },
      { code: 'CA', name: 'Canada', flag: 'üá®üá¶' },
      { code: 'PL', name: 'Poland', flag: 'üáµüá±' },
      { code: 'MA', name: 'Morocco', flag: 'üá≤üá¶' },
      { code: 'SA', name: 'Saudi Arabia', flag: 'üá∏üá¶' },
      { code: 'UZ', name: 'Uzbekistan', flag: 'üá∫üáø' },
      { code: 'PE', name: 'Peru', flag: 'üáµüá™' },
      { code: 'MY', name: 'Malaysia', flag: 'üá≤üáæ' },
      { code: 'AF', name: 'Afghanistan', flag: 'üá¶üá´' },
      { code: 'VE', name: 'Venezuela', flag: 'üáªüá™' },
      { code: 'NP', name: 'Nepal', flag: 'üá≥üáµ' },
      { code: 'AU', name: 'Australia', flag: 'üá¶üá∫' },
      { code: 'KE', name: 'Kenya', flag: 'üá∞üá™' },
      { code: 'OTHER', name: 'Other', flag: 'üåç' }
    ];
    
    // Current user
    let currentUser = null;
    
    // Default priorities data
    const DEFAULT_PRIORITIES = [
      { id: '1', title: 'Climate Change Action', category: 'Environment', description: 'Urgent action to reduce emissions and protect our planet', votes: 0, countryVotes: {} },
      { id: '2', title: 'Universal Healthcare', category: 'Health', description: 'Quality healthcare for everyone regardless of income', votes: 0, countryVotes: {} },
      { id: '3', title: 'End World Hunger', category: 'Poverty', description: 'Food security and nutrition for all people globally', votes: 0, countryVotes: {} },
      { id: '4', title: 'Quality Education for All', category: 'Education', description: 'Free, quality education for every child worldwide', votes: 0, countryVotes: {} },
      { id: '5', title: 'Clean Water Access', category: 'Environment', description: 'Safe drinking water and sanitation for all', votes: 0, countryVotes: {} },
      { id: '6', title: 'Mental Health Awareness', category: 'Health', description: 'Destigmatize and improve mental health resources', votes: 0, countryVotes: {} },
      { id: '7', title: 'Renewable Energy', category: 'Technology', description: 'Shift from fossil fuels to sustainable energy', votes: 0, countryVotes: {} },
      { id: '8', title: 'Gender Equality', category: 'Human Rights', description: 'Equal rights and opportunities for all genders', votes: 0, countryVotes: {} },
      { id: '9', title: 'End Armed Conflicts', category: 'Peace', description: 'Peaceful resolution of armed conflicts', votes: 0, countryVotes: {} },
      { id: '10', title: 'AI Safety & Ethics', category: 'Technology', description: 'Ensure AI benefits humanity safely', votes: 0, countryVotes: {} }
    ];
    
    // Initialize
    function init() {
      // Populate country select
      const select = document.getElementById('countrySelect');
      COUNTRIES.forEach(country => {
        const option = document.createElement('option');
        option.value = country.code;
        option.textContent = `${country.flag} ${country.name}`;
        select.appendChild(option);
      });
      
      // Check if user has country set
      const savedUser = localStorage.getItem('worldPriorityUser');
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        updateUIForUser();
      } else {
        // Auto-show country modal for first-time visitors
        setTimeout(() => showCountryModal(), 1000);
      }
      
      renderPriorities();
      renderCountries();
      updateStats();
    }
    
    // Show/Hide Country Modal
    function showCountryModal() {
      document.getElementById('countryModal').classList.add('active');
    }
    
    function closeCountryModal() {
      document.getElementById('countryModal').classList.remove('active');
    }
    
    // Set Country
    function setCountry() {
      const countryCode = document.getElementById('countrySelect').value;
      if (!countryCode) {
        showAlert('Please select a country', 'error');
        return;
      }
      
      const country = COUNTRIES.find(c => c.code === countryCode);
      const userId = localStorage.getItem('worldPriorityUserId') || 'user_' + Date.now() + '_' + Math.random().toString(36);
      
      currentUser = {
        id: userId,
        country: country.code,
        countryName: country.name,
        countryFlag: country.flag,
        joinedAt: new Date().toISOString()
      };
      
      localStorage.setItem('worldPriorityUser', JSON.stringify(currentUser));
      localStorage.setItem('worldPriorityUserId', userId);
      
      updateUIForUser();
      closeCountryModal();
      showAlert(`Welcome from ${country.name}! üéâ`, 'success');
      renderPriorities();
    }
    
    // Change Country
    function changeCountry() {
      showCountryModal();
    }
    
    // Update UI for user
    function updateUIForUser() {
      document.getElementById('setupSection').style.display = 'none';
      document.getElementById('userSection').style.display = 'flex';
      document.getElementById('userFlag').textContent = currentUser.countryFlag;
      document.getElementById('userCountry').textContent = currentUser.countryName;
    }
    
    // Get priorities
    function getPriorities() {
      const stored = localStorage.getItem('worldPriorities');
      if (stored) {
        return JSON.parse(stored);
      }
      localStorage.setItem('worldPriorities', JSON.stringify(DEFAULT_PRIORITIES));
      return DEFAULT_PRIORITIES;
    }
    
    // Save priorities
    function savePriorities(priorities) {
      localStorage.setItem('worldPriorities', JSON.stringify(priorities));
    }
    
    // Get user votes
    function getUserVotes() {
      if (!currentUser) return [];
      const votes = localStorage.getItem(`votes_${currentUser.id}`);
      return votes ? JSON.parse(votes) : [];
    }
    
    // Save user vote
    function saveUserVote(priorityId) {
      if (!currentUser) return;
      const votes = getUserVotes();
      if (!votes.includes(priorityId)) {
        votes.push(priorityId);
        localStorage.setItem(`votes_${currentUser.id}`, JSON.stringify(votes));
      }
    }
    
    // Update Stats
    function updateStats() {
      const priorities = getPriorities();
      let totalVotes = 0;
      const countriesSet = new Set();
      
      priorities.forEach(p => {
        totalVotes += p.votes || 0;
        if (p.countryVotes) {
          Object.keys(p.countryVotes).forEach(country => countriesSet.add(country));
        }
      });
      
      document.getElementById('totalVotes').textContent = totalVotes.toLocaleString();
      document.getElementById('totalPriorities').textContent = priorities.length;
      document.getElementById('totalCountries').textContent = countriesSet.size || 0;
    }
    
    // Render Countries
    function renderCountries() {
      const priorities = getPriorities();
      const countryStats = {};
      
      // Count votes by country
      priorities.forEach(p => {
        if (p.countryVotes) {
          Object.entries(p.countryVotes).forEach(([country, votes]) => {
            countryStats[country] = (countryStats[country] || 0) + votes;
          });
        }
      });
      
      // Sort by votes
      const sortedCountries = Object.entries(countryStats)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 8);
      
      const container = document.getElementById('countryGrid');
      
      if (sortedCountries.length === 0) {
        container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: rgba(255,255,255,0.4);">No votes yet. Be the first to vote!</div>';
        return;
      }
      
      container.innerHTML = sortedCountries.map(([code, votes]) => {
        const country = COUNTRIES.find(c => c.code === code);
        if (!country) return '';
        return `
          <div class="country-card">
            <div class="flag">${country.flag}</div>
            <div class="country-name">${country.name}</div>
            <div class="country-votes">${votes.toLocaleString()}</div>
          </div>
        `;
      }).join('');
    }
    
    // Render Priorities
    function renderPriorities() {
      const priorities = getPriorities().sort((a, b) => (b.votes || 0) - (a.votes || 0));
      const container = document.getElementById('priorityList');
      const userVotes = getUserVotes();
      
      container.innerHTML = priorities.map((priority, index) => {
        const rank = index + 1;
        const rankClass = rank === 1 ? 'gold' : rank === 2 ? 'silver' : rank === 3 ? 'bronze' : 'normal';
        const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : '';
        
        const hasVoted = currentUser && userVotes.includes(priority.id);
        const canVote = currentUser && !hasVoted;
        
        // Get top 3 countries for this priority
        let countryBreakdown = '';
        if (priority.countryVotes && Object.keys(priority.countryVotes).length > 0) {
          const topCountries = Object.entries(priority.countryVotes)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 3)
            .map(([code, votes]) => {
              const country = COUNTRIES.find(c => c.code === code);
              return country ? `${country.flag} ${votes}` : '';
            })
            .filter(Boolean)
            .join(' ‚Ä¢ ');
          
          if (topCountries) {
            countryBreakdown = `<div class="country-breakdown">Top: ${topCountries}</div>`;
          }
        }
        
        return `
          <div class="priority-card">
            <div class="rank ${rankClass}">${medal || '#' + rank}</div>
            <div class="priority-info">
              <div class="priority-title">${escapeHtml(priority.title)}</div>
              <div class="priority-meta">
                <span class="category-tag">${escapeHtml(priority.category)}</span>
                ${priority.description ? `<span class="priority-desc">${escapeHtml(priority.description)}</span>` : ''}
              </div>
              ${countryBreakdown}
            </div>
            <div class="vote-section">
              <button class="vote-btn ${hasVoted ? 'voted' : ''}" 
                      onclick="vote('${priority.id}')" 
                      ${!canVote ? 'disabled' : ''}
                      title="${!currentUser ? 'Select country to vote' : hasVoted ? 'Already voted' : 'Vote for this priority'}">
                ${hasVoted ? '‚úì' : '‚ñ≤'}
              </button>
              <div class="vote-count">${(priority.votes || 0).toLocaleString()}</div>
            </div>
          </div>
        `;
      }).join('');
    }
    
    // Vote
    function vote(priorityId) {
      if (!currentUser) {
        showCountryModal();
        return;
      }
      
      const userVotes = getUserVotes();
      if (userVotes.includes(priorityId)) {
        showAlert('You already voted for this priority', 'error');
        return;
      }
      
      const priorities = getPriorities();
      const priority = priorities.find(p => p.id === priorityId);
      
      if (!priority) return;
      
      // Increment vote count
      priority.votes = (priority.votes || 0) + 1;
      
      // Track by country
      if (!priority.countryVotes) priority.countryVotes = {};
      priority.countryVotes[currentUser.country] = (priority.countryVotes[currentUser.country] || 0) + 1;
      
      savePriorities(priorities);
      saveUserVote(priorityId);
      
      renderPriorities();
      renderCountries();
      updateStats();
      
      showAlert(`Vote recorded from ${currentUser.countryFlag} ${currentUser.countryName}! üéâ`, 'success');
    }
    
    // Submit Priority
    function submitPriority(event) {
      event.preventDefault();
      
      if (!currentUser) {
        showCountryModal();
        return;
      }
      
      const title = document.getElementById('priorityTitle').value.trim();
      const category = document.getElementById('priorityCategory').value;
      const description = document.getElementById('priorityDesc').value.trim();
      
      if (!title || !category) {
        showAlert('Please fill in required fields', 'error');
        return;
      }
      
      const priorities = getPriorities();
      
      // Check duplicates
      if (priorities.some(p => p.title.toLowerCase() === title.toLowerCase())) {
        showAlert('A similar priority already exists!', 'error');
        return;
      }
      
      const newPriority = {
        id: Date.now().toString(),
        title: title,
        category: category,
        description: description,
        votes: 1,
        countryVotes: { [currentUser.country]: 1 },
        submittedBy: currentUser.countryName,
        createdAt: new Date().toISOString()
      };
      
      priorities.push(newPriority);
      savePriorities(priorities);
      saveUserVote(newPriority.id);
      
      document.getElementById('addPriorityForm').reset();
      
      renderPriorities();
      renderCountries();
      updateStats();
      
      showAlert('Priority submitted successfully! üöÄ', 'success');
    }
    
    // Show Alert
    function showAlert(message, type) {
      const existing = document.querySelector('.alert');
      if (existing) existing.remove();
      
      const alert = document.createElement('div');
      alert.className = `alert alert-${type}`;
      alert.textContent = message;
      document.body.appendChild(alert);
      
      setTimeout(() => alert.remove(), 3000);
    }
    
    // Escape HTML
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text || '';
      return div.innerHTML;
    }
    
    // Close modal on outside click
    document.getElementById('countryModal').addEventListener('click', function(e) {
      if (e.target === this) closeCountryModal();
    });
    
    // Initialize on load
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>